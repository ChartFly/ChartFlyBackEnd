<!-- templates/admin/admin.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>ChartFly Admin Panel</title>

    <link
      rel="icon"
      type="image/x-icon"
      href="/static/images/ChartFly-Favicon.ico"
    />

    <!-- âœ… Stylesheets -->
    <link rel="stylesheet" href="/static/css/styles.css?v=3" />
    <link rel="stylesheet" href="/static/admin/shared/ButtonBox.css?v=3" />
    <link
      rel="stylesheet"
      href="/static/admin/market-holidays/MarketHolidays.css?v=3"
    />
    <link rel="stylesheet" href="/static/admin/api-keys/ApiKeys.css?v=3" />
    <link
      rel="stylesheet"
      href="/static/admin/user-management/UserManagement.css?v=3"
    />
  </head>

  <body>
    <!-- âœ… Header -->
    <div class="admin-header">
      <img
        src="/static/images/Chartfly-logo.png"
        alt="ChartFly Logo"
        class="admin-logo"
      />
      <h1 class="admin-title">ChartFly Admin Console</h1>
      <div id="market-status-indicator">
        Market Status: <span id="market-status-text">Checking...</span>
      </div>
    </div>

    <!-- âœ… Tabs -->
    <div class="tab-container">
      <div class="tab" onclick="switchTab('market-holidays-section')">
        Market Holidays
      </div>
      <div class="tab" onclick="switchTab('api-keys-section')">API Keys</div>
      <div class="tab" onclick="switchTab('user-management-section')">
        User Management
      </div>
    </div>

    <!-- âœ… Market Holidays Section -->
    <section
      id="market-holidays-section"
      class="admin-tab-section"
      style="display: none"
    >
      <h2>ðŸ“… Manage Market Holidays</h2>
      <div data-section="holiday">{% include 'shared/ButtonBox.html' %}</div>
      <div class="table-wrapper">
        <table id="holidays-table" class="admin-table">
          <thead>
            <tr>
              <th class="col-select">Select</th>
              <th class="line-id-col" style="display: none">ID</th>
              <th>Name</th>
              <th>Date</th>
              <th>Close Time</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="5">Loading holidays...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- âœ… API Keys Section -->
    <section
      id="api-keys-section"
      class="admin-tab-section"
      style="display: none"
    >
      <h2>ðŸ”· Manage API Keys</h2>
      <div data-section="api">{% include 'shared/ButtonBox.html' %}</div>
      <div class="table-wrapper">
        <table id="api-keys-table" class="admin-table">
          <thead>
            <tr>
              <th class="col-select">Select</th>
              <th class="line-id-col" style="display: none">ID</th>
              <th>Name</th>
              <th>Provider</th>
              <th>Label</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="6">Loading API keys...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- âœ… User Management Section -->
    <section
      id="user-management-section"
      class="admin-tab-section"
      style="display: none"
    >
      <h2>ðŸ‘¤ Manage Admin Users</h2>
      <div data-section="user">{% include 'shared/ButtonBox.html' %}</div>
      <div class="table-wrapper">
        <table id="user-table" class="admin-table">
          <thead>
            <tr>
              <th class="col-select">Select</th>
              <th class="line-id-col" style="display: none">ID</th>
              <th>Name</th>
              <th>Email</th>
              <th>Phone</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="5">Loading admin users...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- âœ… Shared Scripts -->
    <script src="/static/admin/shared/ButtonBox.js"></script>
    <script src="/static/admin/shared/ButtonBoxMessages.js"></script>
    <script src="/static/admin/shared/ButtonBoxRows.js"></script>
    <script src="/static/admin/shared/ButtonBoxColumns.js"></script>

    <!-- âœ… Section Scripts -->
    <script src="/static/frontend/core/main.js"></script>
    <script src="/static/admin/market-holidays/MarketHolidays.js"></script>
    <script src="/static/admin/market-holidays/ButtonBoxMarketHolidays.js"></script>
    <script src="/static/admin/api-keys/ApiKeys.js"></script>
    <script src="/static/admin/api-keys/ButtonBoxApiKeys.js"></script>
    <script src="/static/admin/user-management/UserManagement.js"></script>
    <script src="/static/admin/user-management/ButtonBoxUserManagement.js"></script>

    <!-- âœ… Footer Ticker -->
    <footer class="admin-footer">
      <div class="footer-ticker">
        <span id="holiday-ticker" class="ticker-content">ðŸŽ‰ Loading...</span>
        <span
          id="holiday-ticker-duplicate"
          class="ticker-content"
          aria-hidden="true"
          >ðŸŽ‰ Loading...</span
        >
      </div>
    </footer>

    <!-- âœ… Tab Switcher -->
    <script>
      function switchTab(sectionId) {
        document.querySelectorAll(".admin-tab-section").forEach((section) => {
          section.style.display = section.id === sectionId ? "block" : "none";
        });

        document.querySelectorAll(".tab").forEach((tab) => {
          tab.classList.toggle(
            "active",
            tab.getAttribute("onclick").includes(sectionId)
          );
        });

        if (
          sectionId === "market-holidays-section" &&
          !window.MARKET_TAB_LOADED
        ) {
          window.MARKET_TAB_LOADED = true;
          loadMarketHolidays();
        }

        if (sectionId === "api-keys-section" && !window.API_TAB_LOADED) {
          window.API_TAB_LOADED = true;
          loadApiKeys();
        }

        if (
          sectionId === "user-management-section" &&
          !window.USER_TAB_LOADED
        ) {
          window.USER_TAB_LOADED = true;
          loadAdminUsers();
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        switchTab("market-holidays-section");
      });
    </script>
  </body>
</html>
