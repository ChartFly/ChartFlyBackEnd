<!-- =================================================== -->
<!-- âœ… ChartFly Admin Panel Layout (admin.html)         -->
<!-- Main layout for the Admin Dashboard UI              -->
<!-- Includes: Header, Tabs, Footer, Shared Scripts      -->
<!-- Author: ChartFly Dev Team                           -->
<!-- Last Updated: 2025-04-11                            -->
<!-- =================================================== -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>ChartFly Admin Panel</title>

    <link
      rel="icon"
      type="image/x-icon"
      href="/static/images/ChartFly-Favicon.ico"
    />

    <!-- âœ… Stylesheets -->
    <link rel="stylesheet" href="/static/css/styles.css" />
    <link
      rel="stylesheet"
      href="/static/admin/market-holidays/MarketHolidays.css"
    />
    <link rel="stylesheet" href="/static/admin/shared/ButtonBox.css" />
  </head>

  <body>
    <!-- âœ… Header -->
    <div class="admin-header">
      <img
        src="/static/images/Chartfly-logo.png"
        alt="ChartFly Logo"
        class="admin-logo"
      />
      <h1 class="admin-title">ChartFly Admin Console</h1>
      <div id="market-status-indicator">
        Market Status: <span id="market-status-text">Checking...</span>
      </div>
    </div>

    <!-- âœ… Tabs -->
    <div class="tab-container">
      <div class="tab" onclick="showTab('market-holidays')">
        Market Holidays
      </div>
      <div class="tab" onclick="showTab('api-keys')">API Keys</div>
      <div class="tab" onclick="showTab('user-management')">
        User Management
      </div>
    </div>

    <!-- âœ… Tab Sections -->
    <div id="market-holidays-section" class="tab-section">
      {% include "admin/market-holidays/MarketHolidays.html" %}
    </div>
    <div id="api-keys-section" class="tab-section" style="display: none">
      {% include "admin/api-keys/ApiKeys.html" %}
    </div>
    <div id="user-management-section" class="tab-section" style="display: none">
      {% include "admin/user-management/UserManagement.html" %}
    </div>

    <!-- âœ… Shared Modules -->
    <script src="/static/admin/shared/ButtonBox.js"></script>
    <script src="/static/admin/shared/ButtonBoxMessages.js"></script>
    <script src="/static/admin/shared/ButtonBoxRows.js"></script>
    <script src="/static/admin/shared/ButtonBoxColumns.js"></script>

    <!-- âœ… Frontend Core -->
    <script src="/static/frontend/core/main.js"></script>

    <!-- âœ… Market Holidays -->
    <script src="/static/admin/market-holidays/MarketHolidays.js"></script>
    <script src="/static/admin/market-holidays/ButtonBoxMarketHolidays.js"></script>

    <!-- âœ… API Keys -->
    <script src="/static/admin/api-keys/ApiKeys.js"></script>
    <script src="/static/admin/api-keys/ButtonBoxApiKeys.js"></script>

    <!-- âœ… User Management -->
    <script src="/static/admin/user-management/UserManagement.js"></script>
    <script src="/static/admin/user-management/ButtonBoxUserManagement.js"></script>

    <!-- âœ… Footer with Holiday Ticker -->
    <footer class="admin-footer">
      <div class="footer-ticker">
        <span id="holiday-ticker" class="ticker-content">ðŸŽ‰ Loading...</span>
        <span
          id="holiday-ticker-duplicate"
          class="ticker-content"
          aria-hidden="true"
          >ðŸŽ‰ Loading...</span
        >
      </div>
    </footer>

    <!-- âœ… Updated Tab Switching Logic -->
    <script>
      function showTab(tabName) {
        const tabMap = {
          "market-holidays": "market-holidays-section",
          "api-keys": "api-keys-section",
          "user-management": "user-management-section",
        };

        for (const [key, sectionId] of Object.entries(tabMap)) {
          const section = document.getElementById(sectionId);
          if (section)
            section.style.display = key === tabName ? "block" : "none";

          const tab = document.querySelector(`.tab[onclick*="${key}"]`);
          if (tab) tab.classList.toggle("active", key === tabName);
        }

        if (tabName === "api-keys" && typeof loadApiKeys === "function") {
          loadApiKeys();
        } else if (
          tabName === "user-management" &&
          typeof loadAdminUsers === "function"
        ) {
          loadAdminUsers();
        } else if (
          tabName === "market-holidays" &&
          typeof loadMarketHolidays === "function"
        ) {
          loadMarketHolidays();
        }

        location.hash = tabName;
      }

      document.addEventListener("DOMContentLoaded", () => {
        const tab = location.hash.replace("#", "") || "market-holidays";
        showTab(tab);
      });
    </script>
  </body>
</html>
